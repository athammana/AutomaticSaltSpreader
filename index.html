<!DOCTYPE html>
<htm lang="en">
<head>
	<meta charset="utf-8">
	<title>Particle Connection</title>
</head>

<body>

	<h1>Automatic Salt Spreader Controls<sup>TM</sup></h1>
	<h2>Device #1</h2>

	<form name="myForm" method="POST" id="myFormId">
		<p>Device ID:<input id="deviceId" name="myCoreID" size=50 value="480025000e504b464d323520"> <br> Get this from the core area when logged in<br></p>
		<p>Access Token:<input id="access_token" name="myCoreID" type=password size=50 value="2914fec95e7f2ed423645e2d456604076901a3fd"> <br> Get this from the core area when logged in<br></p>
	</form>

	<button type="turnLedOnButton" onclick="getParticle('on', 'led')">Turn Led On</button>
	<button type="turnLedOffButton" onclick="getParticle('off', 'led')">Turn Led Off</button>
	<br><br>
	<button type="dispenseButton" onclick="getParticle('true', 'dispense')">Dispense Salt</button>
	<button type="updatePressureButton" onclick="getParticle('value', 'update')">Update Pressure Sensor Value</button>

	<p id="Response">Led has not been updated</p>
	<br>
	<p id="Pressure Value">Pressure Value</p>

</body>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<!-- <link href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css" rel="stylesheet"> -->
<script type="text/javascript">

	function getParticle(input, func){
		var coreID = document.all.deviceId.value;
		var accessToken = document.all.access_token.value;
		var url = "https://api.spark.io/v1/devices/" + coreID + "/" + func;
	
        $.ajax({
			type: "POST",
			url: url,
			data: {
				access_token: accessToken,
				args: input
			},
			success: (data) => {
				console.log(data);
				if (func = 'led'){
					if (data.return_value == 1)
						document.getElementById("Response").innerHTML = "Led is On";
					else
						document.getElementById("Response").innerHTML = "Led is Off";
				} else if (func = 'dispense'){
					document.getElementById("Response").innerHTML = "Salt has been dispensed";
				} else if(func = 'update'){
					document.getElementById("Response").innerHTML = "Pressure Value has been updated";
					document.getElementById("Pressure Value").innerHTML = data.return_value;
				}
			},
	    });
	}

</script>

</html>
